I"¾!<ul id="markdown-toc">
  <li><a href="#emacs-å¿«æ·é”®" id="markdown-toc-emacs-å¿«æ·é”®">Emacs å¿«æ·é”®</a></li>
  <li><a href="#valgrind-ç®€ä»‹" id="markdown-toc-valgrind-ç®€ä»‹">Valgrind ç®€ä»‹</a></li>
  <li><a href="#makefile-ç®€ä»‹" id="markdown-toc-makefile-ç®€ä»‹">MakeFile ç®€ä»‹</a></li>
</ul>

<h2 id="emacs-å¿«æ·é”®">Emacs å¿«æ·é”®</h2>

<p>â€ƒâ€ƒæœ€è¿‘ç”±äºè¯¾ç¨‹è¦æ±‚ï¼Œä¸å¾—ä¸å¼€å§‹å­¦ä¹ Emacsçš„ä½¿ç”¨ï¼Œå¼€ä¸ªåšå®¢è®°å½•ä¸€ä¸‹Emacsç—›è‹¦çš„å…¥é—¨ä¹‹è·¯ï¼Œç®€å•è®°å½•ä¸€ä¸‹å¸¸ç”¨çš„å¿«æ·é”®ã€‚æŒç»­æ›´æ–°ingâ€¦</p>

<p>æ³¨ï¼šå…³äºEmacså’ŒVimçš„åŒºåˆ«ï¼Œ<a href="https://mp.weixin.qq.com/s/KTaEuy7kfm7t1bwQmvE32Q">è¿™é‡Œ</a>æœ‰ä¸€ç¯‡å¾ˆå¥½çš„æ–‡ç« </p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Command</th>
      <th style="text-align: center">Shortcut</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">Open(â€œvisitâ€) file</td>
      <td style="text-align: center">C-x C-f</td>
    </tr>
    <tr>
      <td style="text-align: center">Save current buffer(an open file)</td>
      <td style="text-align: center">C-x C-s</td>
    </tr>
    <tr>
      <td style="text-align: center">Save as [another name]</td>
      <td style="text-align: center">C-x C-w</td>
    </tr>
    <tr>
      <td style="text-align: center">Quit Emacs</td>
      <td style="text-align: center">C-x C-c</td>
    </tr>
    <tr>
      <td style="text-align: center">Suspend Emacs</td>
      <td style="text-align: center">C-z</td>
    </tr>
    <tr>
      <td style="text-align: center">Resume Emacs(when it is suspended)</td>
      <td style="text-align: center">fg</td>
    </tr>
    <tr>
      <td style="text-align: center">Undo</td>
      <td style="text-align: center">C-_</td>
    </tr>
    <tr>
      <td style="text-align: center">Set mark(then you can select a region text using your cursor)</td>
      <td style="text-align: center">C-@</td>
    </tr>
    <tr>
      <td style="text-align: center">Cut(Kill)</td>
      <td style="text-align: center">C-w</td>
    </tr>
    <tr>
      <td style="text-align: center">Copy</td>
      <td style="text-align: center">M-w</td>
    </tr>
    <tr>
      <td style="text-align: center">Paste</td>
      <td style="text-align: center">C-y</td>
    </tr>
    <tr>
      <td style="text-align: center">Page down(up)</td>
      <td style="text-align: center">C-v(M-v)</td>
    </tr>
  </tbody>
</table>

<p>æœç´¢çš„åŠŸèƒ½ç›¸ä¿¡æ˜¯å¾ˆå¤šäººæ—¥å¸¸çš„éœ€æ±‚ï¼ŒEmacså½“ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å†…ç½®çš„isearchè¿›è¡Œæœç´¢ï¼š</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Command</th>
      <th style="text-align: center">Shortcut</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">Enter isearch mode</td>
      <td style="text-align: center">M-x isearch-forward (then you can enter the keyword)</td>
    </tr>
    <tr>
      <td style="text-align: center">Jump to next occurrence</td>
      <td style="text-align: center">C-s</td>
    </tr>
    <tr>
      <td style="text-align: center">Jump to previous occurrence</td>
      <td style="text-align: center">C-r</td>
    </tr>
    <tr>
      <td style="text-align: center">Exit and place the cursor at origin position</td>
      <td style="text-align: center">C-g</td>
    </tr>
    <tr>
      <td style="text-align: center">Exit and place the cursor at current position</td>
      <td style="text-align: center">Enter</td>
    </tr>
  </tbody>
</table>

<h2 id="valgrind-ç®€ä»‹">Valgrind ç®€ä»‹</h2>

<p>valgrindå®é™…ä¸Šæ˜¯ä¸€ç³»åˆ—å·¥å…·çš„é›†åˆï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä¸»è¦å…³æ³¨å…¶ä¸­çš„<strong>å†…å­˜æ£€æŸ¥</strong>å·¥å…·ï¼Œå¯ä»¥è®©æˆ‘ä»¬æ£€æŸ¥ç¨‹åºæ˜¯å¦å­˜åœ¨å†…å­˜æ³„éœ²çš„é—®é¢˜ï¼ˆå¦‚ï¼šmallocåˆ†é…äº†å†…å­˜ä½†æ˜¯æ²¡æœ‰freeï¼Œç©ºæŒ‡é’ˆâ€¦ï¼‰</p>

<p><strong>å¦‚ä½•ä½¿ç”¨ï¼Ÿ</strong></p>

<p>ç®€å•çš„ä½¿ç”¨valgrindæŒ‡ä»¤æ¥è¿è¡Œä½ çš„ç¨‹åºå°±å¥½<code class="language-plaintext highlighter-rouge">valgrind ./myProgram hello 42</code></p>

<p><strong>æœŸå¾…è¾“å‡º</strong></p>

<p>å¦‚æœä½ ä½¿ç”¨valgrindè¿è¡Œä½ çš„ç¨‹åºï¼Œä½ åº”è¯¥æœŸå¾…å¾—åˆ°ä»¥ä¸‹çš„è¾“å‡ºï¼š</p>

<p><img src="/img/valgrind_expected_output.png" alt="expected output" /></p>

<ul>
  <li>All heap blocks were freed â€“ no leaks are possibleï¼ˆæ²¡æœ‰å†…å­˜æ³„æ¼ï¼Œæ‰€æœ‰ç©ºé—´éƒ½å·²æ­£ç¡®é‡Šæ”¾ï¼‰</li>
  <li>ERROR SUMMARY: 0 errors from 0 contextsï¼ˆç¨‹åºæ²¡æœ‰é”™è¯¯ï¼‰</li>
</ul>

<p><strong>å¸¸è§é”™è¯¯</strong></p>

<p><img src="/img/uninitalized_value.png" alt="uninitalized_value" /></p>

<ul>
  <li>æœ‰æ—¶å€™ä½ ä¼šï¼ˆä¸ç»æ„é—´ï¼‰ä½¿ç”¨åˆ°ä¸€äº›æœªåˆå§‹åŒ–çš„å˜é‡(å°¤å…¶æ˜¯ä½ ä½¿ç”¨<code class="language-plaintext highlighter-rouge">malloc</code>çš„æ—¶å€™ï¼Œ å¦‚<code class="language-plaintext highlighter-rouge">char * str = malloc(cnt * sizeof(* str))</code>ï¼Œè¿™ä¼šä½¿å¾—ä½ å¾—åˆ°çš„æŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªæœªåˆå§‹åŒ–çš„å†…å­˜ï¼Œç›¸åº”çš„ä½ åº”è¯¥ä½¿ç”¨ <code class="language-plaintext highlighter-rouge">calloc</code>, <code class="language-plaintext highlighter-rouge">char * str = calloc(cnt * sizeof(* str))</code>)</li>
</ul>

<p><img src="/img/invalidate_readwrite.png" alt="invalidate_read/write" /></p>

<ul>
  <li>æœ‰æ—¶å€™ä½ ä¼šï¼ˆä¸ç»æ„é—´ï¼‰è®¿é—®åˆ°ä¸€ä¸‹ä¸åº”è¯¥è®¿é—®çš„å†…å­˜ï¼ˆå¸¸ç”±äºæ•°ç»„è¶Šç•Œå¯¼è‡´ï¼‰</li>
</ul>

<pre><code class="language-C">char * str1 = "Hello World";
char * str2 = calloc(cnt * sizeof(* str2));
strcpy(str2, str1);
</code></pre>

<p>æ³¨æ„ <code class="language-plaintext highlighter-rouge">strcpy</code> ä¼šåœ¨å­—ç¬¦ä¸²çš„ç»“å°¾è‡ªåŠ¨æ·»åŠ  <code class="language-plaintext highlighter-rouge">\0</code> ï¼Œ æ‰€ä»¥åˆ†é…å†…å­˜çš„æ—¶å€™ï¼Œä½ éœ€è¦ä¸ºç»“æŸç¬¦å¤šåˆ†é…ä¸€ä¸ªå†…å­˜ç©ºé—´</p>

<p><strong>å¸¸ç”¨æŒ‡ä»¤</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>valgrind <span class="nt">--track-origins</span><span class="o">=</span><span class="nb">yes</span> <span class="nt">--leak-check</span><span class="o">=</span>full ./myProgram
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">--track-origins=yes</code> å‘Šè¯‰valgrindæ˜¾ç¤ºå¯¼è‡´æ¯ä¸€ä¸ªé”™è¯¯å‘ç”Ÿçš„å…·ä½“ä»£ç ä½ç½®</li>
  <li><code class="language-plaintext highlighter-rouge">--leak-check=full</code> å‘Šè¯‰valgrindæ˜¾ç¤ºæ¯ä¸€ä¸ªå†…å­˜æ³„æ¼çš„å…·ä½“ä¿¡æ¯ï¼ˆç”±ä»€ä¹ˆå¯¼è‡´ï¼Œåœ¨å“ªé‡Œå‘ç”Ÿï¼‰</li>
</ul>

<h2 id="makefile-ç®€ä»‹">MakeFile ç®€ä»‹</h2>

<p>åœ¨ C é‡Œé¢ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code class="language-plaintext highlighter-rouge">gcc</code> è¿›è¡Œç¼–è¯‘</p>

<div class="language-make highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">CFLAGS</span><span class="o">=</span><span class="nt">-std</span><span class="o">=</span>gnu99 <span class="nt">-pedantic</span> <span class="nt">-Wall</span> <span class="nt">-Werror</span> <span class="nt">-ggdb3</span>
<span class="nl">all</span><span class="o">:</span> <span class="nf">main.o</span>
	gcc <span class="nt">-o</span> rand_story <span class="nv">$(CFLAGS)</span> main.o
<span class="nl">main.o</span><span class="o">:</span> <span class="nf">main.c catarray.h</span>
	gcc <span class="nt">-c</span> <span class="nv">$(CFLAGS)</span> main.c

<span class="nl">.PHONY</span><span class="o">:</span> <span class="nf">clean</span>
<span class="nl">clean</span><span class="o">:</span>
	<span class="nb">rm</span> <span class="nt">-r</span> rand_story <span class="k">*</span>.o <span class="k">*</span>~
</code></pre></div></div>

<p>åœ¨ C++ é‡Œé¢ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code class="language-plaintext highlighter-rouge">g++</code> è¿›è¡Œç¼–è¯‘</p>

<div class="language-make highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">CFLAGS</span><span class="o">=</span> <span class="nt">-pedantic</span> <span class="nt">-Wall</span> <span class="nt">-Werror</span> <span class="nt">-ggdb3</span>
<span class="nl">all</span><span class="o">:</span> <span class="nf">code.o</span>
        <span class="err">g++</span> <span class="err">-o</span> <span class="err">code_output</span> <span class="err">$(CFLAGS)</span> <span class="err">code.o</span>
<span class="nl">code.o</span><span class="o">:</span> <span class="nf">code.cpp</span>
        <span class="err">g++</span> <span class="err">-c</span> <span class="err">$(CFLAGS)</span> <span class="err">code.cpp</span>

<span class="nl">.PHONY</span><span class="o">:</span> <span class="nf">clean</span>
<span class="nl">clean</span><span class="o">:</span>
        <span class="err">rm</span> <span class="err">-r</span> <span class="err">code_output</span> <span class="err">*.o</span> <span class="err">*~</span>
</code></pre></div></div>
:ET